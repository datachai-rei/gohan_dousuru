<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="gohan_dousuru.css">
    <title>gohan_dousuru</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🍋</text></svg>">
</head>
<body>
<form method="POST" action="https://script.google.com/macros/s/AKfycbxDlxRGjk6iyrZlcHEzV-WfJH8MylQWPCr25-gOQ_YTf5wVePqzIL0GUCvPQazgZFWG/exec">
    <label for="ingredient">食材から献立を選ぶ</label>
    <div class="tile-container">
        <div class="tile" data-value="ピーマン">
            <img src="image/ピーマン.png" alt="ピーマン">
            <div>ピーマン</div>
        </div>
        <div class="tile" data-value="キャベツ">
            <img src="image/キャベツ.png" alt="キャベツ">
            <div>キャベツ</div>
        </div>
        <div class="tile" data-value="玉ねぎ">
            <img src="image/玉ねぎ.png" alt="玉ねぎ">
            <div>玉ねぎ</div>
        </div>
        <div class="tile" data-value="人参">
            <img src="image/人参.png" alt="人参">
            <div>人参</div>
        </div>
        <div class="tile" data-value="セロリ">
            <img src="image/セロリ.png" alt="セロリ">
            <div>セロリ</div>
        </div>
        <div class="tile" data-value="レタス">
            <img src="image/レタス.png" alt="レタス">
            <div>レタス</div>
        </div>
    </div>
    <input type="hidden" name="selected_items" id="selected_items">
　　<br><br>
    <label for="date1">日付①</label>
    <br>
    <input type="date" id="date1" name="date1">
    <br><br>
    <label for="main1">メイン料理</label>
    <br>
    <select name="main1" id="main1">
        <option value="おまかせ">おまかせ</option> 
        <!-- MAIN_OPTIONS_PLACEHOLDER -->
        <option value="その他">その他</option> 
    </select>
    <input type="text" id="other_main1" class="other-input tw-hidden" name="other_main1" placeholder="その他のメイン料理">
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const selectElement = document.getElementById('main1'); 

            selectElement.addEventListener('change', function() {
                const otherInput = document.getElementById('other_main1'); 

                if (this.value === 'その他') {
                    otherInput.classList.remove('tw-hidden');
                    otherInput.required = true; 
                } else {
                    otherInput.required = false; 
                    otherInput.value = ''; 
                }
            });
        });
    </script>
    <br><br>
    <label for="side1">副菜</label>
    <br>
    <select name="side1" id="side1">
        <option value="おまかせ">おまかせ</option>
        <!-- SIDE_OPTIONS_PLACEHOLDER -->
        <option value="その他">その他</option> 
    </select>
    <input type="text" id="other_side1" class="other-input tw-hidden" name="other_side1" placeholder="その他の副菜">
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const selectElement = document.getElementById('side1'); 

            selectElement.addEventListener('change', function() {
                const otherInput = document.getElementById('other_side1'); 

                if (this.value === 'その他') {
                    otherInput.classList.remove('tw-hidden');
                    otherInput.required = true; 
                } else {
                    otherInput.required = false; 
                    otherInput.value = ''; 
                }
            });
        });
    </script>
    <br><br>
    <label for="soup1">汁物</label>
    <br>
    <select name="soup1" id="soup1">
        　<option value="おまかせ">おまかせ</option>  
          <!-- SOUP_OPTIONS_PLACEHOLDER -->
          <option value="その他">その他</option> 
    </select>
    <input type="text" id="other_soup1" class="other-input tw-hidden" name="other_soup1" placeholder="その他の汁物">
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const selectElement = document.getElementById('soup1'); 

            selectElement.addEventListener('change', function() {
                const otherInput = document.getElementById('other_soup1'); 

                if (this.value === 'その他') {
                    otherInput.classList.remove('tw-hidden');
                    otherInput.required = true; 
                } else {
                    otherInput.required = false; 
                    otherInput.value = ''; 
                }
            });
        });
    </script>
    <br><br><br>
    <label for="date2">日付②</label>
    <br>
    <input type="date" id="date2" name="date2">
    <br><br>
    <label for="main2">メイン料理</label>
    <br>
    <select name="main2" id="main2">
          <option value="おまかせ">おまかせ</option>  
          <!-- MAIN_OPTIONS_PLACEHOLDER -->
          <option value="その他">その他</option> 
    </select>
    <input type="text" id="other_main2" class="other-input tw-hidden" name="other_main2" placeholder="その他のメイン料理">
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const selectElement = document.getElementById('main2'); 

            selectElement.addEventListener('change', function() {
                const otherInput = document.getElementById('other_main2'); 

                if (this.value === 'その他') {
                    otherInput.classList.remove('tw-hidden');
                    otherInput.required = true; 
                } else {
                    otherInput.required = false; 
                    otherInput.value = ''; 
                }
            });
        });
    </script>
    <br><br>
    <label for="side2">副菜</label>
    <br>
    <select name="side2" id="side2">
        　<option value="おまかせ">おまかせ</option>
          <!-- SIDE_OPTIONS_PLACEHOLDER -->
          <option value="その他">その他</option> 
    </select>
    <input type="text" id="other_side2" class="other-input tw-hidden" name="other_side2" placeholder="その他のメイン副菜">
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const selectElement = document.getElementById('side2'); 

            selectElement.addEventListener('change', function() {
                const otherInput = document.getElementById('other_side2'); 

                if (this.value === 'その他') {
                    otherInput.classList.remove('tw-hidden');
                    otherInput.required = true; 
                } else {
                    otherInput.required = false; 
                    otherInput.value = ''; 
                }
            });
        });
    </script>
    <br><br>
    <label for="soup2">汁物</label>
    <br>
    <select name="soup2" id="soup2">
        　<option value="おまかせ">おまかせ</option>  
          <!-- SOUP_OPTIONS_PLACEHOLDER -->
          <option value="その他">その他</option> 
    </select>
    <input type="text" id="other_soup2" class="other-input tw-hidden" name="other_soup2" placeholder="その他の汁物">
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const selectElement = document.getElementById('soup2'); 

            selectElement.addEventListener('change', function() {
                const otherInput = document.getElementById('other_soup2'); 

                if (this.value === 'その他') {
                    otherInput.classList.remove('tw-hidden');
                    otherInput.required = true; 
                } else {
                    otherInput.required = false; 
                    otherInput.value = ''; 
                }
            });
        });
    </script>
    <br><br><br>
    <label for="date3">日付③</label>
    <br>
    <input type="date" id="date3" name="date3">
    <br><br>
    <label for="main3">メイン料理</label>
    <br>
    <select name="main3" id="main3">
          <option value="おまかせ">おまかせ</option>  
          <!-- MAIN_OPTIONS_PLACEHOLDER -->
          <option value="その他">その他</option> 
    </select>
    <input type="text" id="other_main3" class="other-input tw-hidden" name="other_main3" placeholder="その他のメイン料理">
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const selectElement = document.getElementById('main3'); 

            selectElement.addEventListener('change', function() {
                const otherInput = document.getElementById('other_main3'); 

                if (this.value === 'その他') {
                    otherInput.classList.remove('tw-hidden');
                    otherInput.required = true; 
                } else {
                    otherInput.required = false; 
                    otherInput.value = ''; 
                }
            });
        });
    </script>
    <br><br>
    <label for="side3">副菜</label>
    <br>
    <select name="side3" id="side3">
        　<option value="おまかせ">おまかせ</option>
          <!-- SIDE_OPTIONS_PLACEHOLDER -->
          <option value="その他">その他</option> 
    </select>
    <input type="text" id="other_side3" class="other-input tw-hidden" name="other_side3" placeholder="その他の副菜">
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const selectElement = document.getElementById('side3'); 

            selectElement.addEventListener('change', function() {
                const otherInput = document.getElementById('other_side3'); 

                if (this.value === 'その他') {
                    otherInput.classList.remove('tw-hidden');
                    otherInput.required = true; 
                } else {
                    otherInput.required = false; 
                    otherInput.value = ''; 
                }
            });
        });
    </script>
    <br><br>
    <label for="soup3">汁物</label>
    <br>
    <select name="soup3" id="soup3">
        <option value="おまかせ">おまかせ</option>  
        <!-- SOUP_OPTIONS_PLACEHOLDER -->
        <option value="その他">その他</option>  
    </select>
    <input type="text" id="other_soup3" class="other-input tw-hidden" name="other_soup3" placeholder="その他の汁物">
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const selectElement = document.getElementById('soup3'); 

            selectElement.addEventListener('change', function() {
                const otherInput = document.getElementById('other_soup3'); 

                if (this.value === 'その他') {
                    otherInput.classList.remove('tw-hidden');
                    otherInput.required = true; 
                } else {
                    otherInput.required = false; 
                    otherInput.value = ''; 
                }
            });
        });
    </script>
    <br><br>
    <button type="submit" class="submit-button">送信</button>
    <script
        src="https://www.google.com/recaptcha/api.js?onload=onloadCallback&render=6Lc3f24qAAAAAEjlxS9uQ_7-LcofVac7MyJZqdQh"></script>
    
    <script type="text/javascript">
        async function getGoogleRecaptchaToken() {
            var token = await grecaptcha.execute('6Lc3f24qAAAAAEjlxS9uQ_7-LcofVac7MyJZqdQh', { action: 'submit' })
            $('.submit').removeAttr('disabled')
            $('input[name="grecaptcha"]').val(token)
        }
        var onloadCallback = function () {
            getGoogleRecaptchaToken()
            setInterval(function () {
                $('.submit').prop('disabled', true)
                getGoogleRecaptchaToken()
            }, 80000)
        };
    </script>
</form>
</div>
    
<script src="gohan_dousuru.js"></script>
<script>
    document.getElementById("gohan_dousuru").addEventListener("submit", function(event) {
        event.preventDefault(); 
        
        const formData = new FormData(this);
        
        fetch(this.action, {
            method: this.method,
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            if (data.result === "success") {
                window.location.href = "https://rei620m.github.io/gohan_dousuru/gohan_dousuru_success.html";
            } else {
                window.location.href = "https://rei620m.github.io/gohan_dousuru/gohan_dousuru_error.html";
            }
        })
        .catch(error => {
            console.error("Error:", error);
            alert("送信に失敗しました。");
        });
    });
</script>
</body>
</html>
